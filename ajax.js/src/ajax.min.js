/**
 * Javascript Ajax
 * @author: Tom Flidr | tomflidr(at)gmail(dot)com
 * @url: https://github.com/tomFlidr/ajax.js
 * @version: 1.0
 * @date: 2015-10-11
 * @usage:
var xhr = Ajax.load({
	url: 'https://github.com/tomFlidr',
	method: 'post',
	data: { anything: ["to", "serialize"] },
	success: function (data, statusCode, xhr) {},
	type: 'json',
	error: function (responseText, statusCode, xhr) {},
	headers: {},
	async: true
});
*/
var Ajax=function(){};Ajax.handlers={before:[],success:[],abort:[],error:[]};Ajax.defaultHeaders={"X-Requested-With":"XmlHttpRequest","Content-Type":"application/x-www-form-urlencoded"};Ajax.jsonpCallbackParam="callback";Ajax.aa="JsonpCallback";Ajax.H=0;Ajax.beforeLoad=function(a){Ajax.handlers.before.push(a);return Ajax};Ajax.onSuccess=function(a){Ajax.handlers.success.push(a);return Ajax};Ajax.onAbort=function(a){Ajax.handlers.abort.push(a);return Ajax};Ajax.onError=function(a){Ajax.handlers.error.push(a);return Ajax};Ajax.get=function(){var a=new Ajax;return a.s.apply(a,[].slice.apply(arguments)).u()};Ajax.post=function(){var a=new Ajax;return a.s.apply(a,[].slice.apply(arguments)).u("post")};Ajax.load=function(a){return(new Ajax).s(a.url,a.data,a.success,a.type,a.error,a.headers,a.async).u(a.method)};Ajax.prototype={toString:function(){return"[object Ajax]"},s:function(a,b,c,d,f,g,e){function h(){}this.url=a||"";this.data=b||{};this.b=c||h;this.type=(void 0===d?"":d).toLowerCase()||"";this.error=f||h;this.headers=g||{};this.async="undefined"==typeof e?!0:e;this.result={b:!0,data:{}};return this},u:function(a){this.f=!!document.all;return"jsonp"==this.type?this.V():this.W(a).a},V:function(){var a=this,b=document.createElement("script"),c=a.P();a.g=b;a.c=Ajax.H++;a.j=Ajax.aa+a.c;Ajax[a.j]=function(b){a.S(b)};a.data[Ajax.jsonpCallbackParam]=this.O()+"."+a.j;a.F("get");b.setAttribute("src",a.url);a.B();a.result.b=!1;a.f?(b.attachEvent("onreadystatechange",a.m()),b=c.insertAdjacentElement("beforeEnd",b)):(b.setAttribute("async","async"),b.addEventListener("error",a.m(),!0),b=c.appendChild(b));return{url:a.url,id:a.c,abort:function(){a.o();a.A()}}},S:function(a){this.result.b=!0;this.o();this.result.data=a;this.C();this.b(a)},m:function(){var a=this,b=a.g;return a.f?function(c){c=c||window.event;trace(b.readyState);"loaded"!=b.readyState||a.result.b||a.G(c)}:function(b){a.G(b)}},G:function(a){var b=this.m();this.f?this.g.detachEvent("onreadystatechange",b):this.g.removeEventListener("error",b,!0);this.o();this.v=a;this.i();this.l();this.error(this.url,this.c,a)},o:function(){this.g.parentNode.removeChild(this.g);this.f?Ajax[this.j]=void 0:delete Ajax[this.j]},W:function(a){a=(void 0===a?"get":a).toLowerCase();var b=this.F(a);this.c=Ajax.H++;this.a=this.K();this.a.open(a,this.url,this.async);this.ba();this.B();this.X();this.Y(a,b);return this},X:function(){function a(a){b.T(a)}var b=this;b.f?b.a.attachEvent("onreadystatechange",a):b.a.addEventListener("readystatechange",a)},T:function(a){a=a||window.event;scope=this;4==scope.a.readyState&&scope.U(a)},Y:function(a,b){var c=this.a;"get"==a?c.send():"post"==a&&c.send(b)},U:function(a){var b=this.a;200==b.status?this.Z():0===b.status?this.A():(this.result.b=!0,this.v=a,this.w=Error("Http Status Code: "+b.status),this.i(),this.l())},Z:function(){var a=this.a;0===this.type.length&&this.M();this.$();this.result.b?(this.C(),this.b(this.result.data,a.status,a)):(this.l(),this.error(a.responseText,a.status,a))},$:function(){var a=this.a;"json"==this.type?this.I():"xml"==this.type||"html"==this.type?this.J():"text"==this.type&&(this.result.data=a.responseText)},M:function(){var a=this.R();this.type="text";-1<a.indexOf("javascript")||-1<a.indexOf("json")?this.type="json":-1<a.indexOf("html")?this.type="html":-1<a.indexOf("xml")&&(this.type="xml")},R:function(){var a=this.N(),b=a.indexOf("/");-1<b&&(a=a.substr(b+1));return a},N:function(){var a=this.a.getResponseHeader("Content-Type"),b=a.indexOf(";"),a=0<a.length?a.toLowerCase():"";-1<b&&(a=a.substr(0,b));return a},I:function(){try{this.result.data=(new Function("return "+this.a.responseText))()}catch(a){this.result.b=!0,this.w=a,this.i()}},J:function(){var a={},b=window,c=this.a.responseText,d=b.DOMParser;try{d?(a=new d,this.result.data=a.parseFromString(c,"application/xml")):(a=new b.ActiveXObject("Microsoft.XMLDOM"),a.async=!1,this.result.data=a.loadXML(c))}catch(f){this.result.b=!0,this.w=f,this.i()}},K:function(){var a,b=window,c=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(b.XMLHttpRequest)a=new b.XMLHttpRequest;else for(var d=0,f=c.length;d<f;d+=1)try{a=new b.ActiveXObject(c[d])}catch(g){}return a},ba:function(){var a=this.a,b=this.headers,c=Ajax.defaultHeaders,d;for(d in b)a.setRequestHeader(d,b[d]);for(d in c)b[d]||a.setRequestHeader(d,c[d])},F:function(a){var b="?",c=this.url,d=c.indexOf(b);a=a.toLowerCase();"get"==a?(this.data.da=+new Date,a=this.D(),-1<d&&(b=d==c.length-1?"":"&"),this.url=c+b+a):a=this.D();return a},D:function(){var a=this.data;if("string"==typeof a)return a;window.JSON||this.L();return this.ca()},ca:function(){var a=this.data,b=[],c,d=window,f;for(f in a)c="object"==typeof a[f]?d.JSON.stringify(a[f]):a[f].toString(),b.push(f+"="+c);return b.join("&")},L:function(){window.JSON=function(){function a(a){return 10>a?"0"+a:a}function b(a,f){var g,e,h,k;g=/["\\\x00-\x1f\x7f-\x9f]/g;var l;switch(typeof a){case "string":return g.test(a)?'"'+a.replace(g,function(a){var b=c[a];if(b)return b;b=a.charCodeAt();return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)})+'"':'"'+a+'"';case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);case "object":if(!a)return"null";if("function"===typeof a.toJSON)return b(a.toJSON());g=[];if("number"===typeof a.length&&!a.propertyIsEnumerable("length")){k=a.length;for(e=0;e<k;e+=1)g.push(b(a[e],f)||"null");return"["+g.join(",")+"]"}if(f)for(k=f.length,e=0;e<k;e+=1)h=f[e],"string"===typeof h&&(l=b(a[h],f))&&g.push(b(h)+":"+l);else for(h in a)"string"===typeof h&&(l=b(a[h],f))&&g.push(b(h)+":"+l);return"{"+g.join(",")+"}"}}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"};var c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:b,parse:function(a,b){function c(a,d){var e,m;if(d&&"object"===typeof d)for(e in d)Object.prototype.hasOwnProperty.apply(d,[e])&&(m=c(e,d[e]),void 0!==m&&(d[e]=m));return b(a,d)}var e;if(/^[\],:{}\s]*$/.test(a.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c("",e):e;throw new SyntaxError("parseJSON");}}}()},P:function(){for(var a=document.body;null!==a.previousSibling&&void 0!==a.previousSibling&&(a=a.previousSibling,"head"!=a.nodeName.toLowerCase()););return a},B:function(){this.h("before","jsonp"==this.type?[null]:[this.a])},C:function(){var a=this.a,b=this.result.data;this.h("success","jsonp"==this.type?[null,200,b]:[a,a.status,b])},A:function(){this.h("abort","jsonp"==this.type?[null]:[this.a])},l:function(){var a=this.a;this.h("error","jsonp"==this.type?[null,-1,"",this.v]:[a,a.status,a.responseText,this.ea])},h:function(a,b){function c(){}for(var d=Ajax.handlers[a],f=[this.c,this.url,this.type],g=0,e=b.length;g<e;g+=1)f.push(b[g]);g=0;for(e=d.length;g<e;g+=1)c=d[g],"function"==typeof c&&c.apply(null,f)},i:function(){var a=window,b=this.c,c=this.url,d=this.type,f=this.w,g=this.v,e=this.a;a.console&&("jsonp"==d?a.console.log(b,c,d,0,g):a.console.log(b,c,d,e,e.status,e.responseText,f,f.stack))},O:function(){var a=this.toString();return a.substr(8,a.length-9)}};